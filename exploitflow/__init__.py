# Copyright 2022 VÃ­ctor Mayoral-Vilches. All Rights Reserved.
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#
# Inspired by https://github.com/tobegit3hub/miniflow

from . import graph
from . import flow
from . import exploit
from . import killchain
from . import adapters

# General abstractions for exploit flows
Graph = graph.Graph
Flow = flow.Flow

# Basic primitives
Placeholder = exploit.PlaceholderExploit
Constant = exploit.ConstantExploit
Variable = exploit.VariableExploit
Boolean = exploit.BoolExploit
Init = exploit.InitExploit
Add = exploit.AddExploit
Multiple = exploit.MultipleExploit

lobal_variables_initializer = exploit.GlobalVariablesInitializerExploit
local_variables_initializer = exploit.LocalVariablesInitializerExploit
get_variable = exploit.get_variable

basic_all = [Placeholder, Constant, Variable, Boolean, Init, Add, Multiple]

# Reconnaissance primitives
Versions = killchain.reconnaissance.versions.VersionExploit
FakeVersions = killchain.reconnaissance.versions.FakeVersionExploit
Targets = killchain.reconnaissance.targets.TargetsExploit
reconnaissance_all = [Versions, FakeVersions, Targets]

# Adapters
## MSF
adapter_msf_initializer = adapters.AdapterMSF()
Metasploit = exploit.ExploitMSF
adapters_all = [Metasploit]

# All, except basic
exploits_all = [] + reconnaissance_all + basic_all + adapters_all
