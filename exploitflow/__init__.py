# Copyright 2022 VÃ­ctor Mayoral-Vilches. All Rights Reserved.
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#
# Inspired by https://github.com/tobegit3hub/miniflow

from . import adapters
from . import exploit
from . import flow
from . import graph
from . import killchain
from . import models

# General abstractions for exploit flows
Graph = graph.Graph
Flow = flow.Flow

# Basic primitives
Placeholder = exploit.PlaceholderExploit
Constant = exploit.ConstantExploit
Variable = exploit.VariableExploit
Boolean = exploit.BoolExploit
Init = exploit.InitExploit
End = exploit.EndExploit
Add = exploit.AddExploit
Multiple = exploit.MultipleExploit
Idle = exploit.IdleExploit
End = exploit.EndExploit

placeholder = exploit.PlaceholderExploit()
constant = exploit.ConstantExploit(1)
variable = exploit.VariableExploit("var")
boolean = exploit.BoolExploit()
init = exploit.InitExploit()
end = exploit.EndExploit()
add = exploit.AddExploit(constant, constant)
multiple = exploit.MultipleExploit(constant, constant)
idle = exploit.IdleExploit()

lobal_variables_initializer = exploit.GlobalVariablesInitializerExploit
local_variables_initializer = exploit.LocalVariablesInitializerExploit
get_variable = exploit.get_variable

basic_all = [Placeholder, Constant, Variable, Boolean, Init, Add, Multiple, Idle]
basic_all_instances = [placeholder, constant, variable, boolean, init, add, multiple, idle, end]

# Reconnaissance primitives
Versions = killchain.reconnaissance.versions.VersionExploit
FakeVersions = killchain.reconnaissance.versions.FakeVersionExploit
FakeVersions2 = killchain.reconnaissance.versions.FakeVersionExploit2
Targets = killchain.reconnaissance.targets.TargetsExploit

versions = killchain.reconnaissance.versions.VersionExploit()
fake_versions = killchain.reconnaissance.versions.FakeVersionExploit()
fake_versions2 = killchain.reconnaissance.versions.FakeVersionExploit2()
targets = killchain.reconnaissance.targets.TargetsExploit()

reconnaissance_all = [Versions, FakeVersions, Targets]
reconnaissance_all_instances = [versions, fake_versions, targets]
# reconnaissance_all_instances = []

# Adapters
## MSF
adapter_msf_initializer = adapters.AdapterMSF()
Metasploit = exploit.ExploitMSF

metasploit = adapter_msf_initializer.get_name("auxiliary", "scanner/ssh/ssh_login")

adapters_all = [Metasploit]
adapters_all_instances = [metasploit]


# Learning models
## RL
QLearn = models.QLearn

# All, except basic
exploits_all = [] + reconnaissance_all + basic_all + adapters_all
exploits_all_instances = [] + reconnaissance_all_instances + basic_all_instances + adapters_all_instances
# exploits_all = [Versions, Metasploit, Idle]
